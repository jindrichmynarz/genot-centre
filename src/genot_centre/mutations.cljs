(ns genot-centre.mutations)

(def character-sets
  [#{"ï¼¡" "É‘" "ï½" "a" "Î±" "áª" "Ğ°" "A" "Î‘"}
   #{"ï½‚" "ï¼¢" "á›’" "Î²" "B" "ÃŸ" "Î’" "Ğ’" "á´" "b"
     "Ğ¬" "Ê™" "â„¬"}
   #{"â…­" "Ï²" "Ï¹" "C" "Ñ" "ï¼£" "ï½ƒ" "Ğ¡" "â…½" "c"
     "áŸ" "â„‚" "â„ƒ" "â„­"}
   #{"d" "Ä" "á¸" "â…®" "á " "Ä‘" "ï¼¤" "â…¾" "Õª" "ï½„"
     "Ô" "D" "â……" "â…†"}
   #{"e" "Ä˜" "Ğ•" "E" "ï½…" "Î•" "ï¼¥" "á¬" "Ğµ" "â„®"
     "â„¯" "â„°" "â…€" "â…‡"}
   #{"F" "f" "ï¼¦" "ï½†" "Ïœ" "â„‰" "â„±" "â„²"}
   #{"ï½‡" "É¡" "G" "ï¼§" "á€" "ÔŒ" "g" "É¢" "â„Š" "â…"}
   #{"á»" "ï½ˆ" "Êœ" "ï¼¨" "Î—" "H" "Ğ" "Ò»" "h" "â„‹"
     "â„Œ" "â„" "â„" "â„"}
   #{"Î™" "Ø§" "â…°" "â… " "i" "á¥" "l" "á›" "É©" "I" "Ğ†"
     "ï½‰" "Ñ–" "â„" "â„‘" "â„©" "â„¹" "â…ˆ"}
   #{"Ï³" "Ñ˜" "Ğˆ" "j" "J" "á«" "Õµ" "ï½Š" "â…‰"}
   #{"K" "ï½‹" "á›•" "â„ª" "Îº" "Îš" "Ğš" "ï¼«" "k" "á¦"}
   #{"ï½Œ" "á" "â…¼" "L" "Î¹" "â…¬" "ï¼¬" "Ø§" "ÊŸ" "l"
     "â„’" "â„“"}
   #{"â…¯" "Îœ" "M" "Ğœ" "â…¿" "ï¼­" "á·" "á›–" "ï½" "m"
     "Ïº" "â„³"}
   #{"N" "n" "ï¼®" "ï½" "É´" "Î" "â„µ"}
   #{"Î¿" "Ğ" "ï¼¯" "ï½" "ÎŸ" "O" "0" "Õ•" "Ğ¾" "o"
     "â„´" "â™¡"}
   #{"á¢" "p" "Ï" "P" "ï½" "Ñ€" "Î¡" "Ğ " "ï¼°" "â„—"
     "â„˜" "â„™"}
   #{"á‚­" "Q" "q" "ï¼±" "ï½‘" "á‚³" "â„š"}
   #{"ï½’" "á’" "áš±" "R" "Ê€" "r" "ï¼²" "â„›" "â„œ" "â„"
     "â„" "â„Ÿ"}
   #{"ï½“" "s" "Ñ•" "S" "ï¼³" "Ğ…" "á‚½" "áš" "Õ"}
   #{"T" "Ğ¢" "âœ" "á¢" "ğ™" "ï¼´" "ğ“£" "Ï„" "âœ›" "â™±"
     "â™°" "âœš" "âœŸ" "ï½”" "âœ™" "t" "ğ’¯" "ğ“‰" "ğ•¿" "â“‰"
     "âœ" "â˜©" "Î¤" "â˜¨" "â“£" "â„¸"}
   #{"ï¼µ" "ï½•" "Ô±" "Î¼" "Õ" "Ï…" "U" "u" "â‹ƒ" "â„§"}
   #{"Î½" "Ñ´" "v" "Ñµ" "ï½–" "á™" "ï¼¶" "V" "â…´" "â…¤"
     "â„£"}
   #{"Ñ¡" "á³" "W" "w" "ï¼·" "ï½—"}
   #{"ï½˜" "Ğ¥" "Ï‡" "x" "Ñ…" "ï¼¸" "Î§" "â…¹" "X" "â…©"}
   #{"Ê" "ï¼¹" "ï½™" "Y" "Ò®" "Ñƒ" "y" "Î¥" "Î³" "â„½"}
   #{"áƒ" "Î–" "Z" "z" "ï¼º" "ï½š" "â„¤"}])

(def character-mutations
  (reduce (fn [acc homoglyphs]
            (reduce #(assoc %1 %2 homoglyphs)
                    acc
                    homoglyphs))
          {}
          character-sets))

(defn- mutate-char
  [ch & {:keys [mutation-probability]
         :or {mutation-probability 0.9}}]
  (if-let [mutations (and (< (rand) mutation-probability)
                          (character-mutations ch))]
    (-> mutations vec rand-nth)
    ch))

(defn mutate-text
  [s]
  (apply str (map (comp mutate-char str) s)))
